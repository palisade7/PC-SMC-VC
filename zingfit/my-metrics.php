<!DOCTYPE html>
<html id="metrics" class="account">
<?php require_once( 'includes/head.php'); ?>

<div class="page-header">
    <h1>My Performance</h1>
</div>
<div class="page-content">
    <div class="pagination pagination-right">
        <ul> </ul>
    </div>
    <table class="table table-striped account-listing power" id="classlisting">
        <thead>
            <tr>
                <th></th>
                <th>Date</th>
                <th>Class</th>
                <th>Instructor</th>
                <th>Spot</th>
                <th>Avg
                    <br/>RPM</th>
                <th>Max
                    <br/>RPM</th>
                <th>Avg
                    <br>Power</th>
                <th>Max
                    <br>Power</th>
                <th>Total
                    <br>Energy</th>
                <th>Dist.
                    <br/>(Miles)</th>
                <th>Cal.</th>
                <th>Class
                    <br>Rank</th>
            </tr>
        </thead>
        <tbody>
            <tr class="data">
                <td class="nowrap">
                    <a href="#" onclick="fbShareMetrics('zingFit CYCLE TIME', 'Sat 7/19/14 - 9:30 AM', 'http://demo.z.local/reserve/index.cfm?action=Reserve.ride&id=68D30A9594728BC39AA24BE94B319D2184', 84)" title="Share on Facebook" rel="zingtip"><i class="fa fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fdemo%2Ez%2Elocal%2Freserve%2Findex%2Ecfm%3Faction%3DReserve%2Eride%26id%3D68D30A9594728BC39AA24BE94B319D2184&text=zingFit%20CYCLE%20TIME" title="Tweet" rel="zingtip" data-metricsid="84"><i class="fa fa-twitter"></i></a>
                </td>
                <td>Sat 7/19/14 - <span class="nowrap">9:30 AM</span></td>
                <td>CYCLE TIME</td>
                <td>Jeremy</td>
                <td>21</td>
                <td>63</td>
                <td>109</td>
                <td>197</td>
                <td>502</td>
                <td>528</td>
                <td>14</td>
                <td>688</td>
                <td>1</td>
            </tr>
            <tr class="data">
                <td class="nowrap">
                    <a href="#" onclick="fbShareMetrics('zingFit HIP CYCLE', 'Fri 7/18/14 - 3:59 PM', 'http://demo.z.local/reserve/index.cfm?action=Reserve.ride&id=93DB85ED909C13838FF95CCFA94CEBD986', 86)" title="Share on Facebook" rel="zingtip"><i class="fa fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fdemo%2Ez%2Elocal%2Freserve%2Findex%2Ecfm%3Faction%3DReserve%2Eride%26id%3D93DB85ED909C13838FF95CCFA94CEBD986&text=zingFit%20HIP%20CYCLE" title="Tweet" rel="zingtip" data-metricsid="86"><i class="fa fa-twitter"></i></a>
                </td>
                <td>Fri 7/18/14 - <span class="nowrap">3:59 PM</span></td>
                <td>HIP CYCLE</td>
                <td>Jeremy</td>
                <td>40</td>
                <td>72</td>
                <td>129</td>
                <td>116</td>
                <td>213</td>
                <td>309</td>
                <td>16.2</td>
                <td>475</td>
                <td>8</td>
            </tr>
            <tr class="data">
                <td class="nowrap">
                    <a href="#" onclick="fbShareMetrics('zingFit HIP CYCLE', 'Fri 7/18/14 - 3:59 PM', 'http://demo.z.local/reserve/index.cfm?action=Reserve.ride&id=FE9FC289C3FF0AF142B6D3BEAD98A92383', 83)" title="Share on Facebook" rel="zingtip"><i class="fa fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fdemo%2Ez%2Elocal%2Freserve%2Findex%2Ecfm%3Faction%3DReserve%2Eride%26id%3DFE9FC289C3FF0AF142B6D3BEAD98A92383&text=zingFit%20HIP%20CYCLE" title="Tweet" rel="zingtip" data-metricsid="83"><i class="fa fa-twitter"></i></a>
                </td>
                <td>Fri 7/18/14 - <span class="nowrap">3:59 PM</span></td>
                <td>HIP CYCLE</td>
                <td>Jeremy</td>
                <td>41</td>
                <td>77</td>
                <td>119</td>
                <td>32</td>
                <td>140</td>
                <td>62</td>
                <td>12.4</td>
                <td>236</td>
                <td>32</td>
            </tr>
            <tr class="data">
                <td class="nowrap">
                    <a href="#" onclick="fbShareMetrics('zingFit CY,CLE', 'Thu 7/17/14 - 2:00 PM', 'http://demo.z.local/reserve/index.cfm?action=Reserve.ride&id=3EF815416F775098FE977004015C619385', 85)" title="Share on Facebook" rel="zingtip"><i class="fa fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fdemo%2Ez%2Elocal%2Freserve%2Findex%2Ecfm%3Faction%3DReserve%2Eride%26id%3D3EF815416F775098FE977004015C619385&text=zingFit%20CY%2CCLE" title="Tweet" rel="zingtip" data-metricsid="85"><i class="fa fa-twitter"></i></a>
                </td>
                <td>Thu 7/17/14 - <span class="nowrap">2:00 PM</span></td>
                <td>CY,CLE</td>
                <td>Francis</td>
                <td>11</td>
                <td>71</td>
                <td>121</td>
                <td>136</td>
                <td>360</td>
                <td>363</td>
                <td>15.9</td>
                <td>530</td>
                <td>2</td>
            </tr>
            <tr class="data">
                <td class="nowrap">
                    <a href="#" onclick="fbShareMetrics('zingFit CY,CLE', 'Wed 7/16/14 - 3:45 AM', 'http://demo.z.local/reserve/index.cfm?action=Reserve.ride&id=2A38A4A9316C49E5A833517C45D3107088', 88)" title="Share on Facebook" rel="zingtip"><i class="fa fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fdemo%2Ez%2Elocal%2Freserve%2Findex%2Ecfm%3Faction%3DReserve%2Eride%26id%3D2A38A4A9316C49E5A833517C45D3107088&text=zingFit%20CY%2CCLE" title="Tweet" rel="zingtip" data-metricsid="88"><i class="fa fa-twitter"></i></a>
                </td>
                <td>Wed 7/16/14 - <span class="nowrap">3:45 AM</span></td>
                <td>CY,CLE</td>
                <td>Jerry</td>
                <td>17</td>
                <td>70</td>
                <td>129</td>
                <td>71</td>
                <td>233</td>
                <td>191</td>
                <td>15.6</td>
                <td>362</td>
                <td>21</td>
            </tr>
            <tr class="data">
                <td class="nowrap">
                    <a href="#" onclick="fbShareMetrics('zingFit CY,CLE', 'Thu 7/10/14 - 7:30 AM', 'http://demo.z.local/reserve/index.cfm?action=Reserve.ride&id=C7E1249FFC03EB9DED908C236BD1996D87', 87)" title="Share on Facebook" rel="zingtip"><i class="fa fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fdemo%2Ez%2Elocal%2Freserve%2Findex%2Ecfm%3Faction%3DReserve%2Eride%26id%3DC7E1249FFC03EB9DED908C236BD1996D87&text=zingFit%20CY%2CCLE" title="Tweet" rel="zingtip" data-metricsid="87"><i class="fa fa-twitter"></i></a>
                </td>
                <td>Thu 7/10/14 - <span class="nowrap">7:30 AM</span></td>
                <td>CY,CLE</td>
                <td>Phil</td>
                <td>14</td>
                <td>68</td>
                <td>129</td>
                <td>84</td>
                <td>207</td>
                <td>225</td>
                <td>15.1</td>
                <td>402</td>
                <td>18</td>
            </tr>
        </tbody>
        <tfoot>
            <tr class="data">
                <th colspan="5">Averages For All Rides</th>
                <td>70</td>
                <td>122</td>
                <td>106</td>
                <td>275</td>
                <td>280</td>
                <td>14.9</td>
                <td>448</td>
                <td></td>
            </tr>
        </tfoot>
    </table>
    <h3>Average performance in past 6 Classes</h3>
    <div id="bikechartcontainer" style="height: 400px; margin: 0 auto"></div>
</div>
<?php require_once( 'includes/tail.php'); ?>
<script src="/static/highcharts.2.3.3.js"></script>
<script src="/static/highcharts.exporting.2.3.3.js"></script>
<script src="//platform.twitter.com/widgets.js"></script>
<script>
$('a[data-toggle="modal"]').live('click', function(e) {
    e.preventDefault();
    var modalid = $(this).attr('data-target');
    $(modalid).modal('show').appendTo($("body"));
    $(modalid + ' .modal-body').html('loading...').load(this.href);
});
$(document).on('click', '.modal-body a', function(e) {
    e.preventDefault();
    $(this).parents('.modal-body').html('loading...').load(this.href);
});
$(function() {
    var bikechart;
    $(document).ready(function() {
        bikechart = new Highcharts.Chart({
            chart: {
                renderTo: 'bikechartcontainer',
                type: 'line',
                marginRight: 130,
                marginBottom: 25
            },
            title: {
                text: '',
                x: -20 //center
            },
            subtitle: {
                text: '',
                x: -20
            },
            xAxis: {
                categories: ["7/10", "7/16", "7/17", "7/18", "7/18", "7/19"],
                labels: {
                    style: {
                        fontSize: "8px",
                        whiteSpace: "nowrap",
                        height: "50px"
                    }
                }
            },
            yAxis: {
                title: {
                    text: 'Unit'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.x + ': ' + this.y;
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
                x: -10,
                y: 100,
                borderWidth: 0
            },
            series: [{
                name: 'Average RPM',
                data: [68, 70, 71, 72, 77, 63]
            }, {
                name: 'Max RPM',
                data: [129, 129, 121, 129, 119, 109]
            }, {
                name: 'Average Power',
                data: [84, 71, 136, 116, 32, 197]
            }, {
                name: 'Max Power',
                data: [207, 233, 360, 213, 140, 502]
            }, {
                name: 'Total Energy',
                data: [225.3, 190.5, 362.7, 309.3, 62.1, 528.4]
            }]
        });
    });
});

function fbShareMetrics(name, caption, link, metricsid) {
    FB.ui({
        method: 'feed',
        name: name,
        link: link,
        caption: caption,
    }, function(response) {
        registerShare('facebook', metricsid);
    });
}
twttr.ready(function(twttr) {
    twttr.events.bind('tweet', function(event) {
        var metricsid = $(event.target).attr('data-metricsid');
        registerShare('twitter', metricsid);
    });
});

function registerShare(source, metricsid) {
    $.ajax({
        type: 'POST',
        url: '/reserve/index.cfm?action=Account.logMetricsShare',
        data: {
            source: source,
            metricsid: metricsid
        }
    });
}
$('a[rel=zingtip]').tooltip();
</script>
